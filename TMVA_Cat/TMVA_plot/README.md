# TMVA Analysis results:
This repository contains the results of an analysis performed using TMVA. The analysis aimed to discriminate between signal and background events using various classification methods. This README provides a summary of the main findings from the analysis.

### Folder Structure

The plots contained in the "__TMVA_plot__" folder are automatically generated by TMVA by simply adding the line "TMVA::TMVAGui( outfileName )"; it generates a graphics window that executes several analysis macros just by pressing the right selection. It takes as input the weight file generated during the classification and writes the result to the root output file, in this case "TMVACC.root". The plots are automatically saved in a "__plot__" folder within the "__dataset__" folder; in this project they are automatically deleted by the bash file, but the more significant results are reported.

### Analysis Details

The analysis utilized TMVA's capabilities to generate response distributions and probability distributions for signal and background events. Additionally, the analysis evaluated the effectiveness of categorization in improving the separation between signal and background distributions.

### Main Results

1. **Response Distributions**: 
   - Response distributions for the three methods are reported both with and without the categorisation applied; for all three methods, the signal and background distributions overlap, indicating that the models are not effective in discriminating; the separation improves with the introduction of categories, although the distributions do not appear to be completely separated; in the latter case, however, all three distributions show two distinguishable peaks for the two classes

<p align="center">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/mva_Fisher.png">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/mva_FisherCat.png">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/mva_HMatrix.png">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/mva_HMatrixCat.png">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/mva_Likelihood.png">
   <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/mva_LikelihoodCat.png">
</p>

2. **Signal Probability Distributions**:
   - Signal probability distributions for signal and background are quite overlapped, confirming that the model is not able to separate completely the two classes; the Fisher method, the two distributions overlap and have no distinguishable peaks. For the likelihood method, the distinction is easier, but since the signal is shifted more towards 1 and the background towards 0, the separation is not net; for the H-Matrix method, the situation is similar to Fisher, but two peaks for signal and background are visible.
  
<p align="center">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/proba_Fisher.png">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/proba_HMatrix.png">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/proba_Likelihood.png">
</p>

3. **Signal Rarity Distribution**:
   - Distribution of signal rarity for the Fisher method has a peak around 1, but the background is present throughout the entire interval, indicating that the signal is more likely to be near 1, but the model is not able to make confident predictions; the situation is similar for the H-matrix. For the likelihood method, the situation is even worse as the distributions overlap a lot, except for two distinguishable peaks around 1 and 0 for signal and background respectively.

<p align="center">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/rarity_Fisher.png">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/rarity_HMatrix.png">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/rarity_Likelihood.png">
</p>

4. **Overtraining Test**:
   - Overtraining test finally shows a similar distribution for the test and training data, and also shows a low value for the Kolmogorov-Smirnov coefficient D; the distribution of the training and test data is therefore similar, indicating that the model has learned well and is able to generalise to new data.
  
<p align="center">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/overtrain_Fisher.png">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/overtrain_FisherCat.png">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/overtrain_HMatrix.png">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/overtrain_HMatrixCat.png">
  <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/overtrain_Likelihood.png">
   <img width="350" height="250" src="https://github.com/edorovati/SC-EXAM/blob/main/TMVA_Cat/TMVA_plot/overtrain_LikelihoodCat.png">
</p>
   
### Conclusion

While the analysis reveals challenges in discriminating between signal and background events, particularly evident in the overlap of probability distributions, the effectiveness of categorization and the generalization capability of the models offer promising avenues for further optimization and improvement.

For detailed analysis results and additional information, please refer to the provided documentation and code files.

